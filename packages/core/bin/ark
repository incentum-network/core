#!/usr/bin/env node

const app = require('commander')
const expandHomeDir = require('expand-home-dir')

app.version(require('../package.json').version)

app
  .command('start')
  .description('start a relay and forging node')
  .option('-c, --config <config>', 'network config', expandHomeDir('~/.ark/config'))
  .option('-b, --bip38 <bip38>', 'forger bip38')
  .option('-a, --address <address>', 'forger address')
  .option('-p, --password <password>', 'forger password')
  .option('--network-start', 'force genesis network start')
  .action(async (options) => require('../lib/start-relay-and-forger')(options))

app
  .command('relay')
  .description('start a relay node')
  .option('-c, --config <config>', 'network config', expandHomeDir('~/.ark/config'))
  .action(async (options) => require('../lib/start-relay')(options))

app
  .command('forge')
  .description('start a forging node')
  .option('-c, --config <config>', 'network config', expandHomeDir('~/.ark/config'))
  .option('-b, --bip38 <bip38>', 'forger bip38')
  .option('-a, --address <address>', 'forger address')
  .option('-p, --password <password>', 'forger password')
  .option('--network-start', 'force genesis network start')
  .action(async (options) => require('../lib/start-forger')(options))

app
  .command('snapshot')
  .description('take a snapshot of the database')
  .option('-c, --config <config>', 'network config', expandHomeDir('~/.ark/config'))
  .action(async (options) => require('../lib/snapshot')(options))

app
  .command('*')
  .action(env => {
    app.help()
    process.exit(0)
  })

app.parse(process.argv)
